<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="icon" type="image/jpg" href="favicon.png" />
    
        <link rel="stylesheet" href="main.css">
    
        <!--FONT AWESOME -->
        <script src="https://kit.fontawesome.com/ca048bf1d7.js" crossorigin="anonymous"></script>
    
        <!--BOOTSTRAP-->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
            integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    
        <!--BOXICON-->
        <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    
        <!--GOOGLE FONTS -->
        <link rel="stylesheet"
            href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    
        <!--DATATABLE-->
        <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/dataTables.bootstrap5.min.css">
        <title>Usuarios</title>
    </head>
<body style="display: flex; flex-direction: column; min-height: 100vh;">

    <!-- INICIO NAV-->

            <!-- Responsive navbar-->
            <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
                <div class="container" data-bs-theme="dark">
                    <a class="navbar-brand" href="#!">Ticket de buses</a>
                    
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                            <li class="nav-item"><a class="nav-link" onclick="cambiarTema()"><i id="dl-icon" class="bi bi-moon-fill"></i></a></li>
                            <li class="nav-item"><a class="nav-link active" aria-current="page" href="/">Logout</a></li>
                        </ul>
                    </div>
                </div>
            </nav> 

    <!-- FIN NAV-->

    <div>
        <div class="text-c ptb-3">
            <H1>USUARIOS</H1>
        </div>
    </div>

    <!--Inicio lista de tipos de usuario-->



    <div class="table-responsive container-fluid">

        <a  href="/usuariosDes" class="btn mtb-1 col-md-2 col-12" id="submit-btn">Habilitar usuario</a>
        <br><br>
        <table id="table" class="table table-striped text-center mt-4">
            <thead id="titletable">
                <tr>
                    <th scope="col">Id</th>
                    <th scope="col">Nombre</th>
                    <th scope="col">Correo</th>
                    <th scope="col">Contraseña</th>
                    <th scope="col">estado</th>
                    <th scope="col">Tipo de usuario</th>
                    <th scope="col">Acciones</th>
                </tr>
            </thead>

            <tbody>
                <% results.forEach((usuario)=>{ %>

                    <tr>
                        <td>
                            <%= usuario.id %>
                        </td>
                        <td>
                            <%= usuario.nombre %>
                        </td>
                        <td>
                            <%= usuario.correo %>
                        </td>
                        <td>
                            <%= usuario.pass %>
                        </td>
                        
                        <td>
                            <%= usuario.estadoNombre %>
                        </td>
                        <td>
                            <%= usuario.tipoNombre %>
                        </td>
                        <td>
                            <a  onclick="confirmar(<%= usuario.id %>, '<%= usuario.nombre %>')" class="btn btn-danger"><span class="material-symbols-outlined">delete</span></a>
                        </td>

                    </tr> 
                    <% }) %>
            </tbody>

        </table>
    </div>
    <!--cdn bootstrap js-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <!--cdn alertas js-->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.5/dist/sweetalert2.all.min.js"></script>

    <!--CDN de la datatables-->
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js"></script>

    <script>
        $(document).ready(function () {
            $('#table').DataTable({
                "language": espanol,

                pageLength: 5,
                lengthMenu: [[5, 10, 20, -1], [5, 10, 20, 'Todo']]
            });

        });

        var espanol = {
            "processing": "Procesando...",
            "lengthMenu": "Mostrar _MENU_ registros",
            "zeroRecords": "No se encontraron resultados",
            "emptyTable": "Ningún dato disponible en esta tabla",
            "infoEmpty": "Mostrando registros del 0 al 0 de un total de 0 registros",
            "infoFiltered": "(filtrado de un total de _MAX_ registros)",
            "search": "Buscar:",
            "infoThousands": ",",
            "loadingRecords": "Cargando...",
            "paginate": {
                "first": "Primero",
                "last": "Último",
                "next": "Siguiente",
                "previous": "Anterior"
            },
            "info": "Mostrando _START_ a _END_ de _TOTAL_ registros",
            "stateRestore": {
                "creationModal": {
                    "button": "Crear",
                    "name": "Nombre:",
                    "order": "Clasificación",
                    "paging": "Paginación",
                    "search": "Busqueda",
                    "select": "Seleccionar",
                    "columns": {
                        "search": "Búsqueda de Columna",
                        "visible": "Visibilidad de Columna"
                    },
                    "title": "Crear Nuevo Estado",
                    "toggleLabel": "Incluir:"
                },
                "emptyError": "El nombre no puede estar vacio",
                "removeConfirm": "¿Seguro que quiere eliminar este %s?",
                "removeError": "Error al eliminar el registro",
                "removeJoiner": "y",
                "removeSubmit": "Eliminar",
                "renameButton": "Cambiar Nombre",
                "renameLabel": "Nuevo nombre para %s",
                "duplicateError": "Ya existe un Estado con este nombre.",
                "emptyStates": "No hay Estados guardados",
                "removeTitle": "Remover Estado",
                "renameTitle": "Cambiar Nombre Estado"
            }




        }
    </script>
    <script>

        function confirmar(id, nombre) {
            Swal.fire({
                title: 'Atencion!',
                text: "¿Estas seguro de querer eliminar al usuario " + nombre + "?",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                cancelButtonText: 'Cancelar',
                confirmButtonText: 'Si, eliminar!'
            }).then((result) => {

                if (result.isConfirmed) {
                    window.location = '/deleteUser/' + id;

                }

            })
        }

    </script>


</body>
</html>